Using device: cpu
Loaded model from epoch 300000
Embeddings shape: torch.Size([128, 64])
Number of singular values: 64

Top 10 singular values: [1594.10498046875, 500.4167785644531, 430.95404052734375, 325.7894592285156, 310.04913330078125, 232.9054412841797, 230.9224090576172, 202.864990234375, 168.12457275390625, 162.14990234375]

Cumulative variance explained:
  Top-1: 71.8%
  Top-2: 78.9%
  Top-3: 84.1%
  Top-5: 89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%
  Top-64: 100.0%

Top singular vector explains 71.8% of variance
This indicates severe rank collapse in the learned representation.

Singular value ratio S[0]/S[1]: 3.19
Singular value ratio S[0]/S[31]: 42.09

Linear fit in log-space (indices 2-43):
  log(S) = 5.9071 + -0.0736 * k
  Slope: -0.0736 (decay rate in log scale)
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
  Top-1:  71.8%
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
Loaded model from epoch 300000
Embeddings shape: torch.Size([128, 64])
Number of singular values: 64

Top 10 singular values: [1594.10498046875, 500.4167785644531, 430.95404052734375, 325.7894592285156, 310.04913330078125, 232.9054412841797, 230.9224090576172, 202.864990234375, 168.12457275390625, 162.14990234375]

Cumulative variance explained:
  Top-1: 71.8%
  Top-2: 78.9%
  Top-3: 84.1%
  Top-5: 89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%
  Top-64: 100.0%
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
============================================================
VARIANCE SPECTRUM SUMMARY
============================================================

Model: 48-layer ReLU MLP, dim=64
Task rank: 32
Training epochs: 300000

Cumulative variance explained:
  Top-1:  71.8%
  Top-2:  78.9%
  Top-3:  84.1%
  Top-5:  89.8%
  Top-10: 95.6%
  Top-20: 98.9%
  Top-32: 99.8%

Components needed for 90% variance: 6

Components needed for 95% variance: 10

Components needed for 99% variance: 21

============================================================
